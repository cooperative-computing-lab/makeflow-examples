<img align=right src=montage.png width=256></img>

Montage Workflow Example
------------------------

This workflow gives an example of using Makeflow to parallelize
the Montage astronomical image mosaic tool.

If you have not done so already, please clone this example repository like so:
```
git clone https://github.com/cooperative-computing-lab/makeflow-examples.git
cd ./makeflow-examples/montage
```

First, build the Montage binary for your architecture:

```
git clone https://github.com/Caltech-IPAC/Montage ./montage
cp ./mDAG.c ./montage/grid/Pegasus
cd montage
make
cd ..
```

Then, create a working directory and generate a workflow:

```
mkdir ./montage_example
./montage/bin/mDAG 2mass j m51 0.5 0.5 0.00277778 ./montage_example http://montage-web.ipac.caltech.edu/workspace/m51
```

Next, run the file_get.pl script to grab all the necessary images of the sky using the URLs generated by mDAG:

```
cp ./file_get.pl ./montage_example
cd ./montage_example
perl ./file_get.pl ./url.list
```

Finally, execute the workflow using makeflow locally,
or using a batch system like Condor, SGE, or Work Queue:

```
makeflow montage.mf
makeflow -T condor montage.mf
makeflow -T sge montage.mf
makeflow -T wq montage.mf
```
